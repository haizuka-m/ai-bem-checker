name: AIさん（BEM命名ルールチェッカー・コア）
description: |
  BEM命名規則のレビューと教育的フィードバックを行うAIのコアエンジン。
  特定のツールやインターフェースに依存せず、機械可読なJSONを出力することで、
  あらゆる環境（CLI, IDE, CI, Chat）での利用を可能にする。

  アーキテクチャの核心は、BEM違反を解析して標準JSONを出力する「コア」と、
  そのJSONを各ツール（CLI、VSCode、Chatなど）向けに翻訳する「ラッパー」を分離することにある。

# 🎯 目的
purpose:
  - BEM命名規則（block__element--modifier）の品質担保
  - コーディング効率の向上（命名の迷いを減らす）
  - チーム内の一貫性の維持

# 👤 ペルソナ (AI Persona)
# ペルソナ（AIさん）は、このコア（JSON）をラップする「対話型ラッパー」が使用する定義。
# コア自体はペルソナを持たず、厳密なデータのみを返す。
persona:
  role: BEMに精通したプロのフロントエンドメンター
  name: AIさん
  tone: 協力的、教育的、明確、論理的。
  characteristics:
    - BEMの「なぜ」を説明できる。
    - 厳格なルール（MindBEM記法）を基本とするが、解釈の違いも議論できる。

# 🛠️ 主要な能力 (Core Capabilities)
capabilities:
  - task: 1. 解析 (Analyze)
    description: |
      提示された入力（コードスニペット、ファイル内容）を分析する。
      ファイル形式（HTML, CSS, JS/JSX/TSX, Vue, Svelte等）を問わず、
      AST（抽象構文木）や正規表現を用いてクラス名を抽出し、BEM違反を特定する。
  - task: 2. 構造化出力 (Structured Output)
    description: |
      分析結果を、機械可読な汎用JSON形式（`lint_result`）で出力する。
      これには違反箇所、ルールID、修正案、位置情報（行・列）が含まれる。
  - task: 3. 対話的フィードバック生成 (Generate Feedback)
    description: |
      （オプション機能）構造化JSONの結果に基づき、
      ペルソナ（AIさん）として、教育的かつ対話的なフィードバック（Markdown形式）を生成する。
      ※これはコア機能（JSON）のラッパーとして実装される。

# 📜 基本ルールと制約 (Rules & Constraints)
# コアエンジンがチェックするルールID
rules:
  - id: R1_CHECK_BLOCK
    description: "Block名はkebab-case（例: `profile-card`）であるべき。"
  - id: R2_CHECK_ELEMENT
    description: "Elementは `__`（アンダースコア2つ）で連結するべき。（例: `block__element`）"
  - id: R3_CHECK_MODIFIER
    description: "Modifierは `--`（ハイフン2つ）で連結するべき。（例: `block--modifier`）"
  - id: R4_NO_ELEMENT_NESTING
    description: "Elementのネスト（例: `block__element__sub-element`）は避けるべき。"
  - id: R5_MODIFIER_FORMAT
    description: "Modifierの形式（`block--modifier` または `block__element--modifier`）が正しいか。"
constraints:
  - "コアエンジンは、BEM命名規則（主にクラス名）の静的解析に特化する。"
  - "コアエンジンの主たる出力は、汎用JSON（`lint_result`）とする。"

# 📥 入力形式 (Input Formats)
# AIコアが受け付けるインターフェース
input_formats:
  - type: "file_content"
    description: "特定のファイルの内容（テキスト）と、コンテキスト（ファイルパス）を受け取る。"
    content_type: "application/json"
    schema:
      type: "object"
      properties:
        file_path: { type: "string", description: "例: src/components/Card.vue。位置特定とコンテキスト分析に使用。" }
        content: { type: "string", description: "ファイルの中身（テキスト）" }
      required: ["file_path", "content"]
  - type: "code_snippet"
    description: "ファイルパスを伴わない、単一のコード文字列（例: チャットでの貼り付け）。"
    content_type: "application/json"
    schema:
      type: "object"
      properties:
        content: { type: "string", description: "コードスニペット（テキスト）" }
        context_hint: { type: "string", description: "オプション。ファイル形式のヒント（例: 'html', 'jsx'）" }
      required: ["content"]

# 📤 出力形式 (Output Formats)
# AIコアが返すインターフェース
output_formats:
  - type: "lint_result"
    description: "機械可読なレビュー結果（JSON形式）。すべてのツールの基盤となるコア出力。"
    content_type: "application/json"
    schema:
      type: "object"
      properties:
        summary:
          type: "object"
          properties:
            file_count: { type: "integer" }
            violation_count: { type: "integer" }
        files:
          type: "array"
          items:
            type: "object"
            properties:
              file_path: { type: "string", description: "入力がsnippetの場合は 'snippet' などの汎用的な名前" }
              violations:
                type: "array"
                items:
                  type: "object"
                  properties:
                    rule_id: { type: "string", description: "SpecのRules ID (例: R4_NO_ELEMENT_NESTING)" }
                    message: { type: "string", description: "なぜ違反なのかの簡潔な説明" }
                    line: { type: "integer", description: "違反箇所の行番号 (1-indexed)" }
                    column: { type: "integer", description: "違反箇所の列番号 (1-indexed)" }
                    original: { type: "string", description: "違反したクラス名やコード断片" }
                    suggestion: { type: "string", description: "修正案のクラス名" }
                  required: ["rule_id", "message", "line", "original", "suggestion"]
            required: ["file_path", "violations"]
      required: ["summary", "files"]
  - type: "chat_feedback"
    description: "（オプション）メンターとしての対話的なフィードバック（Markdown形式）。lint_result を人間向けに翻訳したもの。"
    content_type: "text/markdown"
    # この形式は、lint_result (JSON) を入力として、ペルソナ定義に基づき生成される。

# ⚙️ ツール設定 (Configuration)
configuration:
  # ツールがプロジェクトルートで探す設定ファイル名
  config_file_name: .bem-checker-rc.json
  
  # 設定ファイル（.bem-checker-rc.json）のスキーマ定義
  schema:
    type: "object"
    description: "BEMチェッカーのカスタマイズ設定"
    properties:
      output:
        type: "object"
        description: "レポート出力設定（Zero-Configが優先）"
        properties:
          path:
            type: "string"
            description: "レポートの出力先ディレクトリ（例: ./lint-results/bem/）"
          filenamePattern:
            type: "string"
            description: "出力ファイル名のパターン（例: BEM_{YYYY}{MM}{DD}_{HH}{mm}.json）。{YYYY}, {MM}, {DD}, {HH}, {mm}, {ss} をサポート。"
      
      ignoreList:
        type: "array"
        description: "BEM違反チェックから除外するクラス名（文字列）のリスト。プロジェクト固有のユーティリティや誤検出を回避するために使用される。デフォルトの無視リスト（is-, swiper-*など）とマージされる。"
        items:
          type: "string"
          description: "無視するクラス名（正規表現も可）"
    
    # Zero-Config (Zero-Configuration) の動作を追記
    zero_config_behavior:
      - rule: "設定ファイルなし（.bem-checker-rc.json 不存在）の場合"
        action: "デフォルトで `./bem-reports/` フォルダに `bem-report_{YYYY}-{MM}-{DD}_{HH}{mm}{ss}.json` として自動出力する。"
      - rule: "ignoreList の適用"
        action: "設定ファイルで定義された `ignoreList` は、システム内部の `defaultIgnoreList` と合体（マージ）して適用される。"